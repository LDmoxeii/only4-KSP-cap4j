<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.only4.adapter.infra.mybatis.mapper.AdminUserMapper">

    <select id="getCountByRoleId" resultType="java.lang.Long">
        SELECT COUNT(1)
        FROM admin_user au
                 LEFT JOIN admin_user_role aur
                            ON au.id = aur.admin_user_id
        WHERE aur.role_id = #{roleId}
    </select>
    <select id="existedByName" resultType="java.lang.Long">
        SELECT COUNT(1)
        FROM admin_user
        WHERE name = #{name}
    </select>
    <select id="existedByRoleId" resultType="java.lang.Long">
        SELECT COUNT(1)
        FROM admin_user au
                 LEFT JOIN admin_user_role aur
                           ON au.id = aur.admin_user_id
        WHERE aur.role_id = #{roleId}
    </select>
    <select id="getByRoleId" resultType="com.only4.domain.aggregates.admin_user.AdminUser">
        SELECT *
        FROM admin_user au
                 LEFT JOIN admin_user_role aur
                           ON au.id = aur.admin_user_id
        WHERE aur.role_id = #{roleId}
    </select>
</mapper>
